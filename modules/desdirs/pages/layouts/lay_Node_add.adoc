= Добавление узла

Узлы _Дерева дизайнов_ предназначены для определения тех сущностей, для которых предназначена та или иная разметка. Например, если разметка должна соответствовать определенной пользовательской роли, то в качестве узла следует выбрать роль. В _Дереве дизайнов_ могут быть организованы цепочки соответствий _Состояние-Разметка_, или _Состояния-Роль-Разметка_, или _Роль-Разметка_. Состояния и роли должны быть настроены заранее в соответствующих конструкторах _{dv}_.

Настройка разметок для сущностей производится в несколько этапов. На начальном этапе определяется та сущность, для которой будет использоваться разметка (состояние или роль), а на следующем -- в уже созданный узел добавляется сама разметка из _Списка разметок_ или новая сущность (например, в узел состояния добавляется узел роли). При формировании дерева, разметки должны быть уже созданы и настроены.

Помимо состояний или ролей, разметка может соответствовать самой карточке. В частности, при отсутствии узлов в _Дереве дизайнов_ обязательно будет присутствовать одна разметка, относящаяся к карточке. При необходимости карточке можно поставить в соответствие и другие разметки.

Описание принципа выбора разметки для запущенной карточки содержится в разделе xref:layouts/lay_Layout_autoselect.adoc[Автоматический выбор разметки].

.Чтобы добавить в дерево новый дочерний узел:
. Выделите в _Дереве дизайнов_ узел, в котором нужно создать подчиненный узел.
. Нажмите на кнопку image:buttons/new-node.png[Новый узел]**Новый узел**.
+
Будет открыто окно *Добавление узла дерева дизайна*.
+
.Добавление узла дерева дизайна
image::lay_DesignTree_Node_add.png[Добавление узла дерева дизайна]
+
. Установите переключатель на значение, соответствующее типу создаваемого узла:
+
* _Роль_ -- если требуется создать соответствие _Роль-Разметка_;
* _Состояние_ -- если требуется создать соответствие _Состояние-Разметка_ или _Состояния-Роль-Разметка_;
* _Разметка_ -- если требуется создать соответствие _Карточка-Разметка_.
+
Следует учитывать, что за одну операцию нельзя создать узел роли или состояния и добавить разметку. Такое действие допускается только для соответствий _Карточка-Разметка_.
+
. Задайте значение узла любым из следующих способов:
+
* введите название узла вручную;
* из раскрывающегося списка выберите нужное значение.
+
В списке будут присутствовать все роли, состояния и разметки, настроенные для данного вида.
+
.Пример первого этапа задания соответствия "Роль-Разметка"
image::lay_DesignTree_Node_add_role.png[Пример первого этапа задания соответствия "Роль-Разметка"]
+
. Нажмите на кнопку *ОК*.
+
Созданный узел будет добавлен в дерево.
+
.Пример добавления узла для роли
image::lay_DesignTree_Node_add_role_ex.png[Пример добавления узла для роли]
+
. Установите курсор на созданный узел.
. Нажмите на кнопку image:buttons/new-node.png[Новый узел]**Новый узел**.
. Выберите для созданного ранее узла (в данном примере -- узла роли) нужную разметку.
+
.Добавление узла дерева дизайна
image::lay_DesignTree_Node_add_value.png[Добавление узла дерева дизайна]
+
В дереве для роли будет определена соответствующая разметка.
+
.Результат настройки соответствия "Роль-Разметка"
image::lay_DesignTree_Node_add_value_ex.png[Результат настройки соответствия "Роль-Разметка"]
+
. Аналогичным образом выполните настройку других узлов.
+
Если в _Дереве дизайнов_ на одном уровне в дереве создано несколько разметок, в карточке на ленте будет отображаться кнопка *Дизайн* (если кнопка отмечена в настройках ленты разметки). С помощью данной кнопки можно переключать разметки, выбирая их из выпадающего меню. Если пользователь может выполнять в карточке несколько ролей, и если для этих ролей заданы в дереве разные разметки, то тоже их можно выбирать кнопкой *Дизайн*.
+
.Кнопка и выпадающее меню для переключения разметок в открытой карточке
image::lay_Card_design_button.png[Кнопка и выпадающее меню для переключения разметок в открытой карточке]
+
При первоначальном открытии карточки, по умолчанию к ней применяется разметка, которая находится в дереве дизайнов первой в списке (из числа удовлетворяющих условию разметок).
