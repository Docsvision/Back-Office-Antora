= Сертификат

Сертификат, указанный в карточке сотрудника, используется при подписании документов и заданий с использованием усиленной электронно-цифровой подписи, а также для выполнения операции шифрования/расшифровки файлов в карточках.

Выбор сертификата сотрудника возможен только после его получения на специальном сервере сертификатов в соответствии с системой поддержки электронной цифровой подписи внутри организации. Описание настройки подписания содержится в документе _Руководство по настройке_ в разделе *Типовые сценарии настройки системы\Настройка электронных подписей и шифрования*.

На компьютере пользователя может быть установлено сразу несколько служебных сертификатов. Как правило, управление сертификатами в операционной системе _Windows_ выполняется в _Диспетчере сертификатов_, который открывается при выполнении команды _certmgr.msc_ из командной строки. Также список доступных сертификатов доступен в браузере _Internet Explorer_ (раздел *Internet options*, вкладка *Content*, кнопка *Certificates*).

В карточке сотрудника указать можно только один сертификат, выбрав его из числа доступных. Указанный сертификат будет загружаться при xref:staff/staff_ActiveDirectory.adoc[синхронизации] с _Active Directory_.

. Чтобы указать сертификат в карточке сотрудника, нажмите кнопку *Выбрать* image:buttons/three-dots.png[Три точки] поля *Сертификат*. Для просмотра сертификата нажмите кнопку *Показать сертификат* image:buttons/magn-glass.png[image,width=27,height=24].
+
.Выбор сертификата в карточке сотрудника
image::staff_Employee_main_common_sertificate.png[Выбор сертификата в карточке сотрудника]
+
. Если у пользователя имеется несколько доступных сертификатов, при выполнении операции подписания по умолчанию будет открываться окно, в котором требуется выбрать нужный сертификат.
+
.Выбор сертификата при подписании
image::staff_Sertificate_sign_select.png[Выбор сертификата при подписании]
+
Чтобы отключить появление этого окна, установите флаг *Не показывать окно выбора сертификата*.
+
В этом случае при выполнении подписания в карточках (командой *Подписать* из карточек документа и задания, подписи по операции, а также при выполнении согласования на этапе с режимом _Подписание_) вместо окна выбора сертификата пользователю будет выдано сообщение: `Будет выполнено подписание с помощью сертификата`, содержащее ссылку на сертификат, который указан в карточке сотрудника. После подтверждения операции подписания будет наложена усиленная электронная подпись с использованием указанного сертификата.
+
.Сообщение об используемом для подписания сертификате
image::staff_Sertificate_sign_one.png[Сообщение об используемом для подписания сертификате]
+
Если сертификат, указанный в _Справочнике сотрудников_, просрочен, или не удалось проверить его состояние, пользователю будет выдано сообщение: `Не удалось выполнить подписание с использованием сертификата. Сертификат недействителен или же его состояние не может быть проверено. Обратитесь к администратору системы` и подпись наложена не будет.
+
. Если подписание документов выполняется с помощью криптопровайдера КриптоПро, то при подписании документов с несколькими файлами потребуется вводить пароль при наложении подписи на каждый отдельный файл. Чтобы запрос на ввод пароля выводился единожды (при подписании одного документа) установите флаг *Всегда запрашивать пароль для контейнера ключа*.
+
.Флаг запроса пароля для контейнера ключа на вкладке Основная карточки сотрудника
image::staff_Employee_main_common_sertificate_requestpassword.png[Флаг запроса пароля для контейнера ключа на вкладке Основная карточки сотрудника]
+
[IMPORTANT]
====
Если используется криптопровайдер, отличный от КриптоПро, данный флаг должен быть *снят*, иначе при подписании документов будет возвращена ошибка.
====
+
Данная функциональность работает только при подписании документов сертификатом, выбранным в карточке сотрудника, в противном случае запрос пароля при подписании будет осуществляться согласно правилам криптопровайдера КриптоПро. После ввода некорректного пароля пользователю будет предоставлен стандартный диалог КриптоПро для ввода пароля.
