= Конструктор состояний

_Конструктор состояний_ предназначен для создания состояний объектов, настройки переходов между ними и определения разрешенных операций для каждого состояния. Конструктор работает с _Базовыми объектами_, то есть позволяет создавать и редактировать состояния для созданных видов карточек.

Разрешение на работу с конструктором определяется наличием лицензии.

Состояния необходимы для поддержания жизненного цикла карточки, поэтому для начала работы с карточкой типа _Документ_ или _Задание_ необходимо, чтобы для соответствующего вида было настроено хотя бы одно состояние. Заранее настроенный набор состояний и операций переходов между ними в системе {dv} называется _Автоматом состояний_.

Для карточек типа _Задание_ по умолчанию имеется заранее настроенный автомат состояний, предназначенный для реализации типового жизненного цикла задания. Для карточек типа _Документ_ по умолчанию настроенных состояний не предусмотрено, однако, для карточки доступны все стандартные операции.

== Интерфейс "Конструктора состояний"

Главное окно _Конструктора состояний_ представлено на рисунке.

.Главное окно "Конструктора состояний"
image::state-designer.png[Главное окно "Конструктора состояний"]

.Окно включает следующие элементы:
* Панель выбора библиотеки карточек и вида карточки в библиотеке.
* Область построения автомата состояний: схемы с условным обозначением состояний и операций между ними.
* Область настройки разрешенных операций для выбранного из списка состояния.
* Область настройки операций перехода.

В нижней части окна имеются инструменты изменения масштаба автомата состояний.

.В зависимости от сложности и размера схемы АС, пользователь может изменять масштаб по своему усмотрению:
* Перетаскивание слайдера (влево -- уменьшение масштаба, вправо -- увеличение);
* Использование кнопок image:buttons/state_circle_minus.png[image]и image:buttons/state_circle_plus.png[image];
* Использование колеса мыши при наведении курсора на область графа с удерживанием клавиши `Ctrl`.

== Область "Операции редактирования"

Область *Операции редактирования* расположена в правой части главного окна _Конструктора состояний_.

.Область "Операции редактирования"
image::state_Interface_edit_operations.png[Область "Операции редактирования"]

.Кнопки ленты в Конструкторе состояний
[cols="9%,29%,62",options="header"]
|===
|Кнопка |Название |Описание
|image:buttons/state_add_green_plus_light.png[image] |Добавить операцию |При нажатии этой кнопки в списке *Операций редактирования* появляется новая запись, имя которой можно изменить. Новая операция может быть использована либо как операция перехода между состояниями, либо как действие, связанное с элементом управления (настраивается через _Конструктор разметок_).
|image:buttons/x-red.png[Красный крестик] |Удалить операцию |Позволяет удалить выделенную операцию (стандартную операцию удалить нельзя)
|image:buttons/square-checked.png[Квадрат с галочкой] |Сделать все операции доступными |Позволяет сделать все операции из списка доступными для текущего состояния. После нажатия этой кнопки напротив каждой операции в списке устанавливается флаг.
|image:buttons/square-empty.png[Пустой квадрат] |Сделать все операции недоступными |Данная команда противоположна по смыслу предыдущей: при ее использовании все операции для выделенного состояния становятся недоступными. Команда позволяет одним действием снять флаги со всех операций в списке.
|===

== Область "Операции перехода"

Область *Операции перехода* включает средства управления операциями переходов, а также список самих операций, которые заданы для переходов между состояниями.

.Область "Операции перехода"
image::state_Interface_transition_operations.png[Область "Операции перехода"]

Список операций позволяет включать или отключать доступность для каждой операции, а кнопки на панели инструментов (image:buttons/square-checked.png[Квадрат с галочкой]иimage:buttons/square-empty.png[Пустой квадрат]) -- включать/отключать доступность операции для всего списка операций сразу.

Если операция недоступна (флаг снят), то соответствующий переход между состояниями не будет отображаться в карточке, а стрелка из автомата состояний, соответствующая данному переходу, будет автоматически удалена.
