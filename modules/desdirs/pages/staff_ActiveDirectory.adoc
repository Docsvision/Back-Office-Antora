[[ariaid-title1]]
== Синхронизация с Active Directory

Записи подразделений справочника сотрудников могут синхронизироваться с учетными записями подразделений (Organizational Unity) системы каталогов Active Directory (содержащей доменные учетные записи подразделений, структурированные в соответствии с иерархией организации). Синхронизация данных справочника сотрудников и Active Directory позволяет поддерживать в них единообразие структуры, при этом передача данных может производиться как из [.dfn .term]_Справочника сотрудников_ в систему каталогов [.dfn .term]_Active Directory_, так и из [.dfn .term]_Active Directory_ в [.dfn .term]_Справочник сотрудников_ (при передаче данных в этом направлении можно автоматически создать личные папки для всех пользователей, а также указать их xref:staff_Employee_main_common_sertificate.adoc[сертификаты] для подписания и шифрования файлов). Производить синхронизацию записей [.dfn .term]_Справочника сотрудников_ и данных [.dfn .term]_Active Directory_ может сотрудник, имеющий права на редактирование [.dfn .term]_Справочника сотрудников_.

С системой каталогов [.dfn .term]_Active Directory_ можно синхронизировать как весь справочник сотрудников, так и данные об отдельной организации (подразделении) или группе. Настройки являются общими для всех пользователей. Группу, определенную в справочнике сотрудников, можно синхронизировать с доменной группой, но не с локальной группой Docsvision.

Настройки синхронизации сохраняются между сессиями (после того, как синхронизация с такими настройками производилась). Все системные сообщения о синхронизации записываются в доступный для просмотра *Журнал синхронизации*. Сохранение данных можно производить по кнопке *Сохранить лог*.

Чтобы синхронизировать данные справочника сотрудников и системы каталогов [.dfn .term]_Active Directory_, выполните следующие действия:

. [.ph .cmd]#Нажмите на панели инструментов справочника кнопку [.keyword]*Синхронизация с Active Directory* image:images/Buttons/staff_synchronize.png[image].#
+
Будет открыто окно [.keyword .wintitle]*Синхронизация с Active Directory*.

image::images/staff_ActiveDirectory_synch.png[[.fig--title-label]#Рис. 1. # Окно 'Синхронизация с Active Directory']
. [.ph .cmd]#Установите переключатель на предпочтительный способ направления синхронизации: #
* *Внести изменения из AD в справочник* – в процессе синхронизации данные из домена и подразделения системы каталогов Active Directory, указанного в свойствах организации (источник синхронизации), будут копироваться в справочник сотрудников (приемник синхронизации).
* *Внести изменения из справочника в AD* – в процессе синхронизации данные будут копироваться из справочника сотрудников (источника синхронизации) в подразделение/домен системы каталогов Active Directory, указанное в свойствах организации (приемник синхронизации). По умолчанию используется противоположное направление.
. [.ph .cmd]#Для настройки параметров синхронизации установите/снимите флаги: #
* [.keyword .parmname]_Синхронизировать подразделения_ – осуществляется обмен данными о подразделениях организации;
* [.keyword .parmname]_Синхронизировать группы_ – осуществляется обмен данных о группах организации;
* [.keyword .parmname]_Синхронизировать роли_ – осуществляется обмен данных о ролях организации;
* [.keyword .parmname]_Синхронизировать добавления и переносы_ – осуществляется синхронизация данных о добавленных или перемещенных объектах, если в источник синхронизации с момента предыдущей синхронизации были внесены изменения (добавления и перемещения);
* [.keyword .parmname]_Синхронизировать удаления_ – осуществляется передача данных об удаленных объектах, если с момента предыдущей синхронизации из источника синхронизации были удалены какие-либо объекты; если в источнике синхронизации не будет найдено записи об объекте, он будет удален из «приемника» синхронизации, поэтому к синхронизации удаления необходимо относиться с осторожностью;
* [.keyword .parmname]_Создавать папки_ (параметр установлен по умолчанию и доступен только при направлении синхронизации «Из AD в справочник»): при передаче данных автоматически создаются личные папки для всех пользователей;
* [.keyword .parmname]_Загружать заблокированные учетные записи_ (параметр доступен только при направлении синхронизации «Из AD в справочник»): при передаче данных в справочник будут загружаться все записи AD, включая заблокированные;
* [.keyword .parmname]_Не проверять домен сотрудников_ – параметр по умолчанию не установлен. Используется в случаях, когда требуется игнорировать принадлежность сотрудников к домену. Доступен только для направления _Из справочника в AD_;
* [.keyword .parmname]_Загружать сертификаты_ (параметр доступен только при направлении синхронизации «Из AD в справочник»): при передаче данных происходит подключение сертификатов пользователей. Если пользователь имеет несколько сертификатов, из них подключается первый по порядку следования в Active Directory.
. [.ph .cmd]# В случае необходимости (при нестандартной синхронизации) следует указать соответствие полей справочника сотрудников и атрибутов Active Directory в окне настройки синхронизации, для вызова которого нажмите кнопку [.ph .uicontrol]*Настройки...* в окне [.keyword .wintitle]*Настройка синхронизации с Active Directory*.#
[loweralpha]
.. [.ph .cmd]#При помощи кнопок *Добавить* image:images/Buttons/staff_Add_green_plus.png[image]и *Изменить* image:images/Buttons/staff_Change_green_pencil.png[image] выберите поля [.dfn .term]_Справочника сотрудников_, предназначенных для синхронизации.#
+
Список соответствий полей и атрибутов Active Directory можно посмотреть http://msdn.microsoft.com/en-us/library/aa746392%28VS.85%29.aspx[здесь].
.. [.ph .cmd]#После выполнения необходимых настроек нажмите на кнопку [.ph .uicontrol]*ОК*. #
+
image::images/staff_ActiveDirectory_settings.png[[.fig--title-label]#Рис. 2. # Окно 'Настройка синхронизации с Active Directory']
. [.ph .cmd]#Для запуска синхронизации данных нажмите кнопку [.ph .uicontrol]*Начать*. #
+
Если синхронизация занимает длительное время, и требуется ее прервать, нажмите на кнопку [.ph .uicontrol]*Остановить*.
. [.ph .cmd]#Чтобы синхронизировать с системой каталогов Active Directory данные об одной организации (подразделении), группе или роли, выделите на левой панели справочника нужную строку и выберите пункт контекстного меню *Синхронизация с Active Directory* для отображения окна синхронизации. В диалоге доступны, но по умолчанию не установлены, параметры _Синхронизировать дочерние объекты_, _Синхронизировать группы_ и _Синхронизировать роли_. Если установить эти параметры, синхронизация затронет не только непосредственно выделенный объект (организацию/подразделение/группу/роль), но и содержащиеся в нем вложенные элементы более низких уровней. Дальнейшие действия по синхронизации повторяют шаги, описанные выше.#
+
[NOTE]
====
[.note__title]#Прим.:#

Состав роли синхронизируется только в случае, если соответствующие записи уже есть в справочнике сотрудников.
====

*На уровень выше:* xref:../pages/staff_Work.adoc[Работа со справочником]
