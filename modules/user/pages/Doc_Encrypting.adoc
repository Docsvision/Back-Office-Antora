[[ariaid-title1]]
== Шифрование файлов

Возможность шифрования файлов реализована для базового типа карточки [.dfn .term]_Документ_. Возможность шифрования в карточках становится доступной только после настройки администратором параметров шифрования в справочнике [.dfn .term]_Системные настройки_ (см. руководство администратора модуля «Docsvision 5. Платформа»). В [.dfn .term]_Конструкторе ролей_ для шифрования используется операция [.keyword]*Шифрование файлов*.

Шифрование в карточках становится доступным только для тех пользователей, у которых в [.dfn .term]_Справочнике сотрудников_ указан сертификат.

Для зашифрованных файлов запрещена отправка на согласование, однако разрешено создание заданий и групп заданий. На вкладке [.keyword]*Ссылки* для режима [.keyword .parmname]_Файлы_ запрещен просмотр зашифрованных файлов для сотрудников, у которых не настроен доступ к зашифрованным файлам.

Чтобы зашифровать файлы карточки, выполните следующие действия:

. [.ph .cmd]#Откройте карточку вида [.dfn .term]_Документ_.#
. [.ph .cmd]#На ленте карточки нажмите на кнопку image:images/Buttons/ico_signatures_and_coding.png[image] [.keyword]*Шифрование файлов*.#
+
Если шифрование выполняется для [.dfn .term]_Дополнительных_ файлов, в списке рядом с их названием появится пометка о том, что файл является дополнительным.
+
Будет открыто окно [.keyword .wintitle]*Шифрование файлов*.

image::images/Encoding.png[[.fig--title-label]##Рис. 1. ##Шифрование файлов карточки]
. [.ph .cmd]#В области [.keyword]*Список файлов* выберите файл, для которого требуется настроить шифрование.#
+
Шифрование выполняется сразу для всех файлов, однако список сотрудников, которые будут иметь доступ к зашифрованному файлу, необходимо сформировать отдельно для каждого из файлов.
. [.ph .cmd]#Укажите сотрудников, которые могут иметь доступ к зашифрованному файлу. Для добавления сотрудника в список:#
* нажмите на кнопку image:images/Buttons/add_green_plus.png[image] и выберите запись из [.dfn .term]_Справочника сотрудников_;
* введите первые буквы имени сотрудника в строку быстрого поиска, затем дважды щелкните левой клавишей мыши на найденной записи.
+
Допускается выбор только тех сотрудников, у которых в Справочнике сотрудников указан сертификат подписи. Если сертификат отсутствует, при подтверждении выбора будет выдано предупреждение: `Не удалось добавить сотрудника. У                         пользователя <ФИО> отсутствует сертификат. Обратитесь к администратору                         системы`.
. [.ph .cmd]#Нажмите на кнопку [.keyword]*Зашифровать*.#
+
При этом возможно появление окна для выбора сертификата подписи.
. [.ph .cmd]#Укажите тип подписи, затем нажмите на кнопку [.ph .uicontrol]*ОК*.#
+
Если сертификат действителен, выполняется шифрование файлов (основных и/или дополнительных) в соответствии с настройками провайдера, алгоритма и ключа из справочника [.dfn .term]_Системные настройки_. Сертификаты пользователей, указанных в списке, берутся из настроек [.dfn .term]_Справочника сотрудников_. Для каждого из указанных пользователей формируется ключ.

В карточке название зашифрованного файла изменит цвет на серый, а в иконке файла появится значок, указывающий, что файл зашифрован.

Зашифрованный файл будет отображаться в списке файлов документа для всех пользователей, имеющих доступ к данной карточке, однако прочитать такой файл могут только пользователи, у которых настроен доступ к зашифрованному файлу. Если доступа нет, будет выдано сообщение: `Файл зашифрован. Не удалось                             выполнить операцию в связи с ограничением прав доступа`. При открытии на чтение зашифрованного файла будет выполнена автоматическая дешифровка файла и выгрузка его во временную папку.

У пользователя, который выполнил шифрование файлов, на ленте карточки станет доступным выпадающее меню кнопки [.keyword]*Шифрование файлов*, содержащее команды для управления зашифрованными файлами.

image::images/Encoding_menu.png[[.fig--title-label]##Рис. 2. ##Меню управления зашифрованными файлами]
. [.ph .cmd]#Если в карточку был добавлен новый файл (основной и/или дополнительный), для его шифрования выберите в меню кнопки команду [.keyword]*Зашифровать файлы*. #
+
Если для дополнительных файлов шифрование в справочнике [.dfn .term]_Системные настройки_ не настроено, при добавлении к карточке дополнительного файла команда для шифрования файлов останется недоступной.
+
После расшифровывания становится возможным редактирование.
. [.ph .cmd]#Чтобы расшифровать файлы, выберите в меню кнопки команду [.keyword]*Расшифровать файлы*.#
+
Файлы будут расшифрованы и станут доступны всем пользователям.
. [.ph .cmd]#Чтобы отредактировать список сотрудников, для которых было выполнено шифрование, выберите в меню кнопки команду [.keyword]*Редактировать список сотрудников*, в открывшемся окне [.keyword .wintitle]*Шифрование файлов* отредактируйте список и затем нажмите на кнопку [.keyword]*Зашифровать*. #
+
Аналогичные действия будут выполнены при нажатии на саму кнопку [.keyword]*Шифрование файлов*.
+
При изменении состава сотрудников будет выполнено повторное шифрование файлов с учетом изменений. При этом, возможно, будет запрошен сертификат подписи.

*На уровень выше:* xref:../pages/Dcard.adoc[Работа с карточкой «Документ»]
