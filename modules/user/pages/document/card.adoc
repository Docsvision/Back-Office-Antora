= Работа с карточкой "Документ"

Карточка _Документ_, входящая в состав библиотеки _{bo}_, предназначена для работы с документами и файлами в организациях различного профиля.

Карточка входит в комплект поставки системы _{dv} 5_. Название карточки соответствует названию её типа в _Справочнике видов карточек_.

Карточка _Документ_ взаимодействует с другими объектами -- заданиями, процессами, справочниками. Разметка и функциональность карточки также могут быть изменены, что позволяет специалистам по внедрению системы реализовывать любые пользовательские сценарии.

.В карточке реализованы следующие операции:
* Создание карточки различными способами.
* Перетаскивание файлов и писем в карточку из xref:document/DCard_file_add_drag_and_drop_filesystem.adoc[файловой системы], другой xref:document/DCard_file_add_drag_and_drop_Dcard.adoc[открытой карточки] и xref:document/DCard_file_add_Outlook.adoc[Microsoft Outlook] как в открытую карточку, так и с созданием новой карточки.
* Возможность xref:Card_extra_vote.adoc[проведения опросов] с выводом результатов в виде гистограммы.
* Поддержка xref:document/DCard_sign.adoc[электронных подписей] в формате `.p7s` и xref:document/DCard_sign_log_view.adoc[просмотра журнала] подписей.
* xref:document/DCard_file_preview.adoc[Предварительный просмотр] файлов поддерживаемых форматов.
* xref:document/DCard_file_versions.adoc[Управление версиями файлов].
* xref:document/DCard_category_control.adoc[Управление категориями файлов].
* Добавление xref:document/DCard_file_scan.adoc[отсканированных файлов] в карточку, в том числе с возможностью xref:document/DCard_file_scan_recognition.adoc[распознавания].
* Для файлов документов в формате _MS Office 2016x86_ и младше поддерживается xref:document/DCard_properties_synsynchronization.adoc[синхронизация свойств] вложенного файла и карточки.
* xref:document/DCard_barcode_print.adoc[Изменение, генерация и печать штрих-кода], а также xref:document/DCard_create_by_barcode.adoc[создание карточки по штрих-коду].
* xref:document/DCard_export.adoc[Экспорт], xref:document/DCard_print.adoc[печать] и xref:document/DCard_email.adoc[отправка] данных карточки по электронной почте.
* Создание связанных карточек.

Для карточки _Документ_ предусмотрен отдельный диалог, в котором собраны параметры печати, экспорта и отправки данных карточки. Данные действия могут распространяться как на файлы, приложенные к карточке (основной и дополнительные), так и на данные самой карточки.

[#interface]
== Интерфейс карточки "Документ"

Интерфейс карточки _Документ_ определяется разметкой, которая настроена для данной карточки в _Конструкторе разметок_.

В данном разделе приведено описание _базовой_ разметки карточки _Документ_, которая используется для карточки при отсутствии установленных в {dv} дополнительных компонентов (приложения _{ud}_ и др.).

[NOTE]
====
Описание интерфейса карточки в случае использования приложений и дополнительных модулей содержится в документации по продуктам.
====

При необходимости _базовая_ разметка может быть изменена администратором.

.Базовая разметка карточки "Документ"
image::document-main.png[Базовая разметка карточки "Документ"]

.Основными элементами карточки "Документ" являются:
* <<ribbon,Лента>>.
* <<attachments,Область вложений>>.
* <<preview,Область предварительного просмотра>>.
* <<menu,Главное меню>>.
* <<versions,Вкладка "Версии">>.
* <<categories,Вкладка "Категории">>.
* <<history,Вкладка "История">>.
* Строка состояния.

[#ribbon]
=== Лента карточки "Документ"

На ленте карточки _Документ_ расположены основные команды для работы с карточкой. Состав команд может быть различным в зависимости от настройки вида и разметки карточки. Ниже представлена лента с базовым набором команд.

.Лента карточки "Документ"
image::document-ribbon.png[Лента карточки "Документ"]

Команды на ленте разделены по функциональным группам: _Общие_, _Действия_, _Создание карточки_, _Основной файл_, _Подписи и шифрование_.

[cols="25%,10%,20%,45",options="header"]
|===
|Группа |Кнопка |Название |Описание

|Общие
|image:buttons/save.png[Сохранить]
|Сохранить
|Сохранить изменения в карточке.

|
|image:buttons/save-create.png[Сохранить и создать]
|Сохранить и создать
|Сохранить изменения в карточке и создать новую карточку того же вида.

|
|image:buttons/print-barcode.png[image]
|Печать штрих-кода
|Распечатать и изменить штрих-код.

|Действия
|image:buttons/perform.png[Цветные квадратики]
|Выполнить
|Перейти к другому (заранее настроенному) состоянию карточки.

|Бизнес-процессы
|image:buttons/start-b-p.png[image]
|Запустить
|Запустить бизнес-процесс.

|
|image:buttons/stop-b-p.png[image]
|Остановить
|Остановить бизнес-процесс.

|
|image:buttons/view-b-p.png[image]
|Просмотреть
|Просмотреть бизнес-процесс.

|Создание карточки
|image:buttons/create-card.png[Создать картоку]
|Создание карточки
|Создать связанную карточку. Кнопка содержит типы ссылок, которые могут быть использованы для создания карточки данного вида (настраиваются в _Справочнике видов карточек_).

|Основной файл
|image:buttons/file-open.png[image]
|Открыть файл
|Открыть основной файл, приложенный к карточке. Файл в области вложений выделять при этом необязательно.

|
|image:buttons/file-lock.png[image]
|Заблокировать для работы
|Выгрузить файл для работы с ним вне системы (при этом для остальных он блокируется).

|
|image:buttons/file-release.png[image]
|Вернуть с блокировки
|Возобновить доступ к файлу с учетом сделанных в нем изменений (измененный файл загружается в карточку из файловой системы).

|
|image:buttons/file-unlock.png[image]
|Отменить блокировку
|Отменить блокировку взятого в работу файла без учета произведенных в заблокированном файле изменений.

|Подписи и шифрование
|image:buttons/sign.png[image]
|Подписать
|Позволяет подписать карточку с помощью электронной подписи (ЭП). При наличии у пользователя личного сертификата будет использована усиленная ЭП, при отсутствии -- простая ЭП.

|
|image:buttons/sign-log.png[image]
|Журнал подписей
|Просмотреть журнал подписей, а также проверить актуальность подписей.

|
|image:buttons/lock.png[image]
|Шифрование файлов
|Задать шифрование файлов карточки.
|===

[#attachments]
=== Область вложений карточки "Документ"

Область вложений предназначена для хранения файлов, добавленных в карточку различными способами. В новой созданной карточке данная область пуста.

.Пустая "Область вложений" в карточке "Документ"
image::Dcard_file_area.png[Пустая "Область вложений" в карточке "Документ"]

После добавления файлов, в области будут отображаться их названия.

."Область вложений" с добавленными файлами
image::Dcard_file_area_with_files.png["Область вложений" с добавленными файлами]

[#preview]
=== Область предварительного просмотра карточки "Документ"

_Область предварительного просмотра_ предназначена для просмотра содержимого файла в режиме чтения. Размер области предварительного просмотра можно менять, перетаскивая границы блоков. При необходимости данная область может быть скрыта специалистами по настройке системы.

.Область предварительного просмотра карточки "Документ"
image::Dcard_preview_area.png[Область предварительного просмотра карточки "Документ"]

При необходимости размер области предварительного просмотра может быть увеличен.

.Область предварительного просмотра карточки "Документ"
image::Dcard_preview_area_big.png[Область предварительного просмотра карточки "Документ"]

[#menu]
=== Главное меню карточки "Документ"

_Главное меню_ карточки Документ предназначено для доступа к следующим командам:

* Сохранить карточку;
* Сохранить и создать карточку;
* Отправка (xref:document/DCard_print.adoc[печать], xref:document/DCard_export.adoc[экспорт], xref:document/DCard_export_pdf.adoc[экспорт в pdf], xref:document/DCard_email.adoc[отправка по электронной почте]);
* xref:document/DCard_close.adoc[Закрыть карточку].

.Главное меню карточки "Документ"
image::Dcard_menu.png[Главное меню карточки "Документ"]

[#versions]
=== Вкладка "Версии"

Вкладка *Версии* предназначена для учета версий основных файлов карточки _Документ_.

В левой части вкладки отображается список версий для каждого из файлов, образуя тем самым дерево с раскрывающимися подпунктами. Правая часть служит для вывода сведений об авторе и дате изменений.

.Вкладка "Версии"
image::Dcard_versions.png[Вкладка "Версии"]

.Вкладка *Версии* включает панель инструментов, содержащую следующие команды:
[cols="10%,90",options="header"]
|===
|Команда |Описание
|image:buttons/refresh.png[Обновить] |Обновляет список версий.
|image:buttons/version-open.png[image] |Открывает файл текущей версии.
|image:buttons/file-lock.png[image] |Блокирует выбранную версию.
|image:buttons/file-release.png[image] |Возвращает доступ к версии (снимает блокировку) с учетом сделанных в ней изменений.
|image:buttons/file-unlock.png[image] |Отменяет взятие в работу (снимает блокировку) без учета возможных изменений.
|image:buttons/version_comment.png[image] |Позволяет добавить комментарий к документу или версии. Для выбора предусмотрено выпадающее меню: image:/version_comment_menu.png[image]
|image:buttons/version-open.png[image] |Открывает выбранную версию файла в режиме "только чтение".
|image:buttons/version-save.png[Сохранить] |Позволяет скачать выбранную версию файла (сохранить в файловой системе).
|image:buttons/version-current.png[image] |Позволяет сделать выбранную версию файла текущей.
|image:buttons/version-delete.png[image] |Удаляет выбранную версию.
|===

[NOTE]
====
Удалить версию файла, если на её основе сделана другая версия нельзя.
====

[#categories]
=== Вкладка "Категории"

Вкладка *Категории* предназначена для управления принадлежностью текущей карточки к той или иной категории (см. xref:document/DCard_category_control.adoc[Управление категориями]). Перемещение по списку найденных категорий производится как при помощи кнопок, расположенных справа от поля, так и при помощи сочетаний клавиш F3 и Shift+F3 (перемещение по веткам дерева вниз и вверх).

.Вкладка "Категории"
image::Dcard_categories.png[Вкладка "Категории"]

В левой части вкладки отображается _Дерево категорий_, а в правой -- список выбранных категорий, к которым относится данная карточка). Одна из частей вкладок может быть скрыта командой контекстного меню *Вид* > *Список/Дерево/Дерево и список*.

.Контекстное меню вкладки "Категории"
image::Dcard_categories_menu.png[Контекстное меню вкладки "Категории"]

.В контекстном меню вкладки также присутствуют следующие команды:
* _Включить всё_ -- документ будет включен во все доступные категории (включая вложенные категории);
* _Выключить всё_ -- документ будет исключен из всех категорий, в которые он ранее был включен;
* _Свернуть/развернуть всё_ -- данная команда разворачивает дерево категорий если оно свернуто, и сворачивает -- если развернуто;
* _Показать путь_ -- данная команда включает/отключает видимость столбца _Путь_ для списка объектов в области справа. По умолчанию данный столбец отображается.

В верхней части вкладки имеется строка поиска, которая позволяет быстро найти нужную категорию.

[NOTE]
====
Вкладка представляет собой элемент управления _Категории_, расположение и прочие параметры которого могут быть настроены в _Конструкторе разметок_.
====

[#history]
=== Вкладка "История"

Вкладка *История* предназначена для ознакомления с журналом изменений карточки _Документ_.

Вкладка содержит таблицу, состоящую из трех столбцов: Сотрудник, Дата и Описание события. Таким образом, имеется возможность посмотреть историю правок карточки, отслеживать жизненный цикл вложений и определить состав сотрудников, вовлеченных в работу над карточкой.

.Вкладка "История"
image::Dcard_history_tab.png[Вкладка "История"]
