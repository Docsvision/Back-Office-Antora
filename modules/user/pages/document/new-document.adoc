= Создать карточку "Документ"

Карточка _Документ_ может быть создана различными способами. Однако, все способы создания предполагают выбор вида создаваемого объекта. В базовый комплект поставки системы _{dv} 5_ (при отсутствии модуля _{dm}_) входит базовый тип карточки _Документ_.

Данный тип может использоваться для создания карточек, однако его настройки не подлежат изменению. Поэтому, при работе с системой рекомендуется пользоваться дочерними видами карточек, созданными на основе базового типа _Документ_.

[WARNING]
====
Для создания карточек рекомендуется использовать пользовательские виды карточек. Данные виды создаются специалистами по внедрению системы в _Справочнике видов карточек_.
====

.Создание карточки _Документ_ может быть выполнено следующими способами:
include::partial$excerpts.adoc[tags=create]

.Также для карточек "Документ" существуют дополнительные способы создания:
* xref:document/new-document.adoc#from-barcode[Создание карточки по штрих-коду].
* xref:document/new-document.adoc#from-wincl[Создание карточки при перетаскивании файла в {wincl}е].
* xref:additional/additional-links.adoc[По ссылке из другой карточки].
* xref:additional/additional-performance-tree.adoc[Из дерева исполнения связанной карточки].

При создании карточки _Документ_ могут применяться настройки, выполненные для данного вида в _Справочнике видов карточек_. Например, при сохранении карточки может выполняться проверка уникальности атрибутов карточки, синхронизация свойств карточки и вложенного файла и другие действия.

[#from-wincl]
== Создание карточки при перетаскивании файла в {wincl}

Карточка типа _Документ_ (или дочерних видов) может быть создана путем перетаскивания файла в _Область представления_ или пользовательскую папку в _Дереве папок_ {wincl}а.

Данный способ также называется импортом документов. Файлы можно перетащить из _Проводника Windows_ или с _Рабочего стола_. Также можно перетащить письма и вложения из _Microsoft Outlook_.

Перетащить можно как один файл, так и группу файлов. При перетаскивании файла в пользовательскую папку могут устанавливаться ограничения, разрешающие создавать карточки документов только определённых видов.

При перетаскивании одного файла будет создана карточка документа (разрешённого для папки вида), файл будет добавлен в карточку как _основной_. Перетащить файл можно также на уже открытую карточку, при этом файл будет приложен в качестве _основного_. Созданная карточка будет сохранена в системной папке `Карточки -- {bo}` (папка доступна только администратору), а в выбранной пользовательской папке будет отображен ярлык на данную карточку.

.При перетаскивании группы файлов появится окно, в котором требуется выбрать способ создания карточки:
* Либо одну карточку с несколькими вложениями.
* Либо по отдельной карточке на каждое вложение.

По умолчанию для всех перетаскиваемых файлов предлагается создать одну карточку _Документ_. При этом необходимо выбрать, какие из файлов будут основными. Остальные файлы будут добавлены в качестве дополнительных.

Чтобы определить _основные_ файлы, необходимо выставить флаги в полях, расположенных слева от их названия. В поле _Вид_ можно определить вид создаваемой карточки. Если вид не задан, будет создана карточка базового типа _Документ_.

.Окно создания одной карточки при перетаскивании группы файлов
image::document-create-drag.png[Окно создания одной карточки при перетаскивании группы файлов]

Если требуется для каждого файла создать отдельную карточку, выберите опцию *Несколько документов*. В таком случае выбор файлов будет запрещен. В списке можно выделить несколько файлов и указать для них нужный вид в поле _Вид_. Для множественного выделения удерживайте kbd:[Ctrl] или kbd:[Shift].

Таким образом, за один шаг можно назначить произвольной группе файлов нужный вид без необходимости делать это вручную для каждого файла. Файлы из диалога можно удалять с помощью команды _Удалить_ контекстного меню, либо клавишей kbd:[Del] на клавиатуре.

.Окно создания нескольких карточек для каждого из перетаскиваемых файлов
image::document-multiple-cards-drag.png[Окно создания нескольких карточек для каждого из перетаскиваемых файлов]

После задания всех необходимых настроек, нажмите кнопку *Принять*, чтобы создать и открыть новые карточки. Для файлов Microsoft Office или OpenOffice свойства файла автоматически будут перенесены на соответствующие поля карточки. К таким свойствам относится, например, автор документа, название документа, наличие электронной подписи.

Создание карточек методом перетаскивания поддерживает работу с электронными подписями (ЭП) в формате `.p7s`.

.При импорте файла ".p7s" нужно учитывать следующие особенности:
* Перетаскивание в _Область представления_:
** Если `.p7s`-файл содержит в себе файл, создаётся новая карточка документа выбранного вида. В качестве основного файла к карточке прикладывается файл из `.p7s`-файла. Формируются соответствующие ЭП.
** Если `.p7s`-файл не содержит файла, карточка не будет создана.
* Перетаскивание на область "Основного файла" в карточке:
** Если `.p7s`-файл содержит в себе файл, и в поле _Основной файл_ также нет файла, файл из `.p7s`-файла добавляется в поле _Основной файл_. Формируются соответствующие ЭП.
** Если `.p7s`-файл содержит в себе файл, и этого файла нет в поле _Основной файл_, будет предложено его добавить. Если файл есть, будет предложено обновить версию или заменить (если версионирование файлов отключено). В обоих случаях будут сформированы соответствующие ЭП.
** Если `.p7s`-файл не содержит файла, и в поле _Основной файл_ также нет файла, будет выдано сообщение о необходимости сначала загрузить основной файл.
** Если `.p7s`-файл не содержит файл, но в поле _Основной файл_ уже имеется файл, ЭП будет добавлена к текущей версии основного файла.

include::partial$excerpts.adoc[tags=viewer]

[#from-barcode]
== Создание карточки по штрих-коду

Для карточек вида _Документ_ предусмотрена возможность создания карточки по штрих-коду.

.Чтобы создать карточку по штрих-коды, необходимо выполнить следующие условия:
* У пользователя должна быть открыта программа {wincl}.
* Должен быть настроен ручной сканер для возможности сканирования штрих-кодов.
* В _Справочнике видов карточек_ для вида документа, которые предполагается создавать при сканировании, должен быть указан способ создания _Сканирование штрих-кода_.
* В настройках {wincl}а должен быть определён вид карточки, создаваемой по штрих-коду.

Если все описанные выше настройки выполнены, после сканирования штрих-кода ручным сканером создание карточки будет произведено по следующим правилам:

* Если карточка с таким штрих-кодом найдена в системе, она будет открыта.
+
Если будет найдено более одной карточки, появится сообщение: `Найдено Х карточек`. При нажатии на кнопку *ОК* будут открыты все найденные карточки.
+
* Если карточка с таким штрих-кодом не найдена в системе, появится сообщение: `Карточек с таким штрих-кодом не найдено. Вы хотите создать новую?`. При нажатии на кнопку *ОК* карточка будет создана в соответствии с настройками, заданными в _Справочнике видов карточек_ и параметрах {wincl}а.

