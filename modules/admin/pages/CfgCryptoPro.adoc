[[ariaid-title1]]
== Настройка Docsvision для работы с криптопровайдером КриптоПро

Для возможности подписания документов ЭП с использованием криптопровайдера КриптоПро, администратор должен настроить Docsvision. Для этого выполните следующие действия:

. [.ph .cmd]#Установите на компьютер с сервером Docsvision и на клиентские компьютеры компоненты КриптоПро (см. требования в пункте xref:Requirements_software_forsign.adoc[Программное обеспечение, необходимое для работы с сертификатами КриптоПро]).#
. [.ph .cmd]#Откройте справочник [.dfn .term]_Системные настройки_ (от имени администратора Docsvision).#
. [.ph .cmd]#Перейдите в раздел [.ph .menucascade]#[.ph .uicontrol]*Базовые объекты* > [.ph .uicontrol]*Подписи и шифрование*#.#
+
image::images/BO_Signature_and_Encryption.png[[.fig--title-label]##Figure 1. ##Настройки подписи и шифрования базовых объектов]
. [.ph .cmd]#Настройте параметры подписания и шифрования.#
[loweralpha]
.. [.ph .cmd]#В поле [.ph .uicontrol]*Провайдер* выберите значение «Crypto-Pro GOST R 34.10-2012 Cryptographic Service Provider» или «Crypto-Pro GOST R 34.10-2012 Strong Cryptographic Service Provider» (в зависимости от алгоритма, с помощью которого были сгенерированы сертификаты).#
.. [.ph .cmd]#В поле [.ph .uicontrol]*Алгоритм шифрования* выберите «GOST 28147-89».#
.. [.ph .cmd]#В поле [.ph .uicontrol]*Алгоритм подписи* выберите «GOST R 34.11-2012 256» или «GOST R 34.11-2012 256» (в зависимости от выбранного [.dfn .term]_провайдера_).#
.. [.ph .cmd]#В поле [.ph .uicontrol]*TSP провайдер* выберите файл [.ph .filepath]`[Каталог установки модуля «Windows-клиент»]/BaseObjects/DocsVision.BackOffice.ObjectModel.CryptoPro.dll`.#
.. [.ph .cmd]#В поле [.ph .uicontrol]*Адрес TSP сервиса* введите адрес службы штампов времени, предоставляющей штампы времени для ЭП.#
+
[NOTE]
====
[.note__title]#Note:# Адрес тестового TSP-сервера компании КриптоПро: http://testca.cryptopro.ru/tsp/tsp.srf.

Для получения актуальных адресов тестового и рабочего TSP-сервера рекомендуется обращаться в компанию КриптоПро.
====
.. [.ph .cmd]#В поле [.ph .uicontrol]*OCSP провайдер* выберите файл [.ph .filepath]`[Каталог установки модуля «Windows-клиент»]/BaseObjects/DocsVision.BackOffice.ObjectModel.CryptoPro.dll`.#
.. [.ph .cmd]#При необходимости настройте остальные параметры.#
+
Указывать адрес OCSP сервиса не требуется.
. [.ph .cmd]#Установите сертификаты КриптоПро:#
[loweralpha]
.. [.ph .cmd]#Корневой сертификат удостоверяющего центра, выпустившего сертификат пользователя xref:#fntarg_1[^1^] в хранилище «Доверенные корневые центры сертификации» на уровне «Локальный компьютер» – на компьютер с сервером Docsvision и на клиентские компьютеры.#
.. [.ph .cmd]#Сертификат пользователя в хранилище «Личное» на уровне «Текущий пользователь» – на клиентские компьютеры.#

[[CfgCryptoPro__postreq_wyz_11p_43b]]
В данной инструкции перечислены действия по настройке Docsvision с точки зрения «классического» варианта установки сертификатов КриптоПро – сертификаты устанавливаются на компьютер пользователя. При использовании функции КриптоПро «Облачный провайдер» (КриптоПро CSP 5.0 и выше), система Docsvision настраивается аналогичным образом, а установка сертификатов должна выполняться по инструкции компании КриптоПро для работы с «облачными токенами».

[.keyword]*Обратите внимание.* В случае, если лицензия на компоненты КриптоПро CSP истекла, блокируется возможность добавления новых подписей. Если подпись была добавлена ранее и срок действия сертификата ЭП не истёк, возможность проверки такой подписи не будет заблокирована. Проверка старых подписей выполняется успешно в любом случае.

*Parent topic:* link:../pages/Administrator_functions.adoc[Функции администратора]

link:#fnsrc_1[^1^] Например, корневой сертификат КриптоПро.
